<!DOCTYPE html>
<html lang="en-us">

  {% include head.html %}

  <body>

    {% include sidebar.html %}

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="{{ site.baseurl }}/" title="Home">{{ site.title }}</a>
            <small>{{ site.tagline }}</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        {{ content }}
      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='{{ site.baseurl }}/public/js/script.js'></script>
     <!-- 新增：引入 Mermaid JS + 渲染脚本（放在 </body> 前） -->
  <!-- Mermaid 核心库（稳定版 CDN） -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
  <!-- 初始化 Mermaid + 识别代码块 -->
  <script>
    // 配置 Mermaid 渲染样式（适配 Lanyon 极简风格）
    mermaid.initialize({
      theme: 'neutral', // 中性主题，匹配 Lanyon 黑白灰风格
      themeVariables: {
        primaryColor: '#f5f5f5',
        borderColor: '#eee',
        textColor: '#333'
      },
      startOnLoad: false, // 手动触发渲染，避免冲突
      securityLevel: 'loose' // 允许自定义样式
    });

    // 识别所有 ```mermaid 代码块，替换为 Mermaid 容器并渲染
    document.addEventListener('DOMContentLoaded', function() {
      // 找到所有 mermaid 代码块
      const mermaidBlocks = document.querySelectorAll('pre code.language-mermaid');
      mermaidBlocks.forEach(block => {
        // 获取代码内容
        const mermaidCode = block.textContent.trim();
        // 创建 Mermaid 容器
        const mermaidDiv = document.createElement('div');
        mermaidDiv.className = 'mermaid';
        mermaidDiv.textContent = mermaidCode;
        // 替换原代码块
        block.parentElement.replaceWith(mermaidDiv);
      });
      // 渲染所有 Mermaid 容器
      mermaid.run();
    });
  </script>
  </body>
</html>
